#!/usr/bin/env python
# -*- coding: utf-8 -*-
import urllib
import sys
import traceback
import re
from xml.etree.ElementTree import parse

def lookup(word):
    dict_url="http://dict.cn/ws.php?utf8=true&q=%s"
    url = dict_url % word
    resXML = parse(urllib.urlopen(url)).getroot()
    p = resXML.find("pron")
    d = resXML.find("def")

    if  p == None:
        word = "[%s]" % word
        url = dict_url % word
        suggestion = parse(urllib.urlopen(url)).getroot()
        referenceWords = ",".join([i.text for i in suggestion.findall("sugg")])
        print "也许您要查找的是:" , referenceWords
    else:
        print "音:" ,p.text
        print "含义:" ,d.text
        print resXML.findall("sent")
        
        for i,sent in enumerate(resXML.findall("sent")):
            print i,sent[0].text
            print "  " + sent[1].text

if __name__ == "__main__":
    while(True):
        word = raw_input("\n输入您要查询的单词(88是退出)：")
        if word == "88":
            break
        elif re.search("^([a-zA-Z]*)$",word)==None:
            print "Does not support C to E"
            break
        else:
            try:
                lookup(word)
            except Exception,e:
                print traceback.format_exc()
